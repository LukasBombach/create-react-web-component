<template id="<%= htmlWebpackPlugin.options.tagName %>">
  <% for (const key in htmlWebpackPlugin.files.css) { %>
  <link href="<%= htmlWebpackPlugin.files.css[key] %>" rel="stylesheet">
  <% } %>
  <% for (const key in htmlWebpackPlugin.files.chunks) { %>
  <script src="<%= htmlWebpackPlugin.files.chunks[key].entry %>" type="text/javascript"></script>
  <% } %>
</template>
<script>
  (function (document) {
    const doc = (document._currentScript || document.currentScript).ownerDocument;
    const proto = Object.create(HTMLElement.prototype, {
      attachedCallback: {
        value: function () {
          const template = doc.querySelector('template#<%= htmlWebpackPlugin.options.tagName %>').content;
          const shadowRoot = this.attachShadow({ mode: 'open' });
          shadowRoot.appendChild(template.cloneNode(true));
        },
      },
    });
    document.registerElement('<%= htmlWebpackPlugin.options.tagName %>', { prototype: proto });
  })(document);
</script>
<<%= htmlWebpackPlugin.options.tagName %>></<%= htmlWebpackPlugin.options.tagName %>>